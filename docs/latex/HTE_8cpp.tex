\hypertarget{HTE_8cpp}{}\doxysection{/home/joshua/projects/metric/population\+\_\+genetics\+\_\+models/\+H\+TE.cpp File Reference}
\label{HTE_8cpp}\index{/home/joshua/projects/metric/population\_genetics\_models/HTE.cpp@{/home/joshua/projects/metric/population\_genetics\_models/HTE.cpp}}


Contains functions to run the Haploid Two Environments model @detail This model explores biological function in the context of a trait that experiences two different environments and has a separate fitness in each environment. The set-\/up is a Wright-\/\+Fisher haploid model\+: one locus with two alleles; one environment with two types At any given time, there is one environment. The environment can change during the simulation however. Let\textquotesingle{}s say that the resident population has trait (allele) a which is invaded by our allele of interest, A Each allele (A/a) has two components to its fitness\+: fitness in env 1 and env 2. Trait/allele a is the resident trait and in environment 1 its fitness is 1 + selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+1 while in environment 2 its fitness is 1 + selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+2. Trait/allele A is our trait of interest and in environment 1 its fitness is 1 + selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+1 while in environment 2 its fitness is 1 + selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+2. For P\+ID purposes, I will fix the fitness of trait a (and thus also fix selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+1 and selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+2). The two \char`\"{}sources\char`\"{} are thus selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+1 and selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+2. P\+ID is used to apportion trait A\textquotesingle{}s function between selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+1 and selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+2 (and to their redundant/synergistic effects).  


{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$numeric$>$}\newline
{\ttfamily \#include $<$random$>$}\newline
{\ttfamily \#include \char`\"{}Parameters.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}H\+T\+E.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}rng.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}persistence\+\_\+probability.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}print\+\_\+results.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}allele\+\_\+invasion.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Data\+Container.\+h\char`\"{}}\newline
\doxysubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \mbox{\hyperlink{namespaceHTE}{H\+TE}}
\begin{DoxyCompactList}\small\item\em Namespace for Haploid Two Environments. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{structHTE__Model__Parameters}{H\+T\+E\+\_\+\+Model\+\_\+\+Parameters}} \mbox{\hyperlink{namespaceHTE_a0db31216fa43fe2b2ffe1e263f63764a}{H\+T\+E\+::parse\+\_\+parameter\+\_\+values}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Reads in parameter values from command line into a struct. \end{DoxyCompactList}\item 
const std\+::vector$<$ double $>$ \mbox{\hyperlink{namespaceHTE_aac280e7bf5217af24fce669a173efb28}{H\+T\+E\+::get\+\_\+fitness\+\_\+function}} (const \mbox{\hyperlink{structHTE__Model__Parameters}{H\+T\+E\+\_\+\+Model\+\_\+\+Parameters}} \&parameters)
\begin{DoxyCompactList}\small\item\em Calculates fitness function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceHTE_a04a6a27af747e17118c4756d4081a7d0}{H\+T\+E\+::calculate\+\_\+allele\+\_\+freqs}} (double \&allele\+\_\+\+A\+\_\+freq, const std\+::vector$<$ double $>$ \&fitnesses, const \mbox{\hyperlink{structHTE__Model__Parameters}{H\+T\+E\+\_\+\+Model\+\_\+\+Parameters}} \&parameters, std\+::mt19937 \&rng, int \&gen)
\begin{DoxyCompactList}\small\item\em Calculates frequency of the A allele after selection. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceHTE_a258b86afcdf6927fd518fe4c0965d3e0}{H\+T\+E\+::run\+\_\+model}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Runs Haploid Two Effects model. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains functions to run the Haploid Two Environments model @detail This model explores biological function in the context of a trait that experiences two different environments and has a separate fitness in each environment. The set-\/up is a Wright-\/\+Fisher haploid model\+: one locus with two alleles; one environment with two types At any given time, there is one environment. The environment can change during the simulation however. Let\textquotesingle{}s say that the resident population has trait (allele) a which is invaded by our allele of interest, A Each allele (A/a) has two components to its fitness\+: fitness in env 1 and env 2. Trait/allele a is the resident trait and in environment 1 its fitness is 1 + selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+1 while in environment 2 its fitness is 1 + selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+2. Trait/allele A is our trait of interest and in environment 1 its fitness is 1 + selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+1 while in environment 2 its fitness is 1 + selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+2. For P\+ID purposes, I will fix the fitness of trait a (and thus also fix selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+1 and selection\+\_\+coefficient\+\_\+a\+\_\+env\+\_\+2). The two \char`\"{}sources\char`\"{} are thus selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+1 and selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+2. P\+ID is used to apportion trait A\textquotesingle{}s function between selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+1 and selection\+\_\+coefficient\+\_\+\+A\+\_\+env\+\_\+2 (and to their redundant/synergistic effects). 

It requires specification of a particular selection regime (i.\+e. environment at each generation). For simplicity, I only consider a selection regime in which environment 1 exists for gen\+\_\+env\+\_\+1 generations, which is followed by environment 2 existing for the remaining generations (until fixation or loss). One interpretation of this model is the evolved for/maintained by distinction (where evolved for is env 1 and maintained by is env 2)

Note that here P\+ID is not strictly necessary in order to calculate the overall function of trait/allele A (since both sources are ultimately derived from trait/allele A), but it is necessary in order to apportion the function of trait/allele A between its effects. If a trait evolves in environment 1 but is maintained due to its effects in environment 2, we might want to quantify the function of the trait\textquotesingle{}s effect in environment 1 separately from its effect in environment 2 